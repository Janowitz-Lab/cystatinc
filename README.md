**Figure 1**

(c) (d) 
Genome-wide association analysis and structural equation modeling 
/ukb_gwas/GWAS_prep.R - processing of UKB data to exclude outlier samples and generate phenotype data for GWAS
/ukb_gwas/UK Biobank QC.ipynb - quality control for UKB genotype data, exclusion of related subjects, identification of ancestry populations
/ukb_gwas/bolt_lmm_run.sh - run command for BOLT-LMM for eGFR-creatinine and eGFR-cystatin C analyses
/sem/Variant_reference.ipynb - construction of variant reference file used by LDpred2
/sem/GenomicSEM.ipynb - derivation of polygenic score using LDpred2

(e) (f) 
Validation of CyC-production PGS
/prs/UKB CyC-production PGS.Rmd

**Figure 2**

(a) (b) (c) 
CyC-production PGS versus mortality or lifespan
/prs/UKB CyC-production PGS.Rmd

(c) Phenome-wide association in UK Biobank
/prs/UKB PheWAS.R

(d)(e) Cancer-specific mortality analyses in UK Biobank and TCGA
/tcga_gtex/TCGA and GTEX germline data processing.ipynb - quality control for TCGA/GTEX genotype data
/prs/PGS analysis TCGA GTEX.ipynb - PGS analysis in TCGA
/prs/UKB PheWAS.R

**Figure 3**

(a) 
eQTS analysis in GTEX
/tcga_gtex/TCGA and GTEX germline data processing.ipynb - quality control for TCGA/GTEX genotype data
/prs/PGS analysis TCGA GTEX.ipynb - GTEX PGS versus RNA-seq analysis workflow

(b) (c) 
Single-cell analyses in human samples
/scRNA-seq/Human scRNA-seq analysis workflow.ipynb

**Figure 5**

(e) 
Single-cell analyses in human samples
/scRNA-seq/Human scRNA-seq analysis workflow.ipynb

**Figure 6**

(e) (f) 
Single cell RNA sequencing analysis of murine Mm1 tumors
/scRNA-seq/Mm1 scRNA-seq analysis.ipynb - processing and downstream analysis of 10X Genomics sequencing data

(h) (i) 
Application of PGS to immunotherapy-treated patients (panIO cohort)
/panIO/panIO cohort processing.ipynb - quality control for panIO genotype data, exclusion of related subjects, identification of ancestry populations, TOPMED
/panIO/CyC-production PGS in panIO.R - prognostic performance of CyC-production PGS in PanIO cohort

**Figure S3**

(b) 
/tcga_gtex/TCGA and GTEX germline data processing.ipynb - quality control for TCGA/GTEX genotype data
/prs/PGS analysis TCGA GTEX.ipynb - GTEX RNA-seq analysis workflow

**Figure S4**

(a) 
/tcga_gtex/TCGA and GTEX germline data processing.ipynb - quality control for TCGA/GTEX genotype data
/prs/PGS analysis TCGA GTEX.ipynb - GTEX PGS versus RNA-seq analysis workflow

**Figure S7**

(a) (b)
/scRNA-seq/Mm1 scRNA-seq analysis.ipynb - processing and downstream analysis of 10X Genomics sequencing data

(d) (e) 
Single cell RNA sequencing analysis of COVID-19 blood samples
/scRNA-seq/scRNA COVID-19 TREM2.ipynb

**Figure S8**

Single-cell analyses in human samples
/scRNA-seq/Human scRNA-seq analysis workflow.ipynb
